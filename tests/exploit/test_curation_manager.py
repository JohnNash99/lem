import unittest
import os

from lem.exploit import CurationManager
from lem.exploit import ExploitSource

class TestCurationManager(unittest.TestCase):
    def setUp(self):
        self.test_data_path = os.path.join(os.path.dirname(os.path.realpath(__file__)),
                                           '..',
                                           'test_data')
        self.curation_dir = os.path.join(self.test_data_path, 'lem-curation')
        self.exploit_dir = os.path.join(self.test_data_path, 'exploit-source')

        self.exploit_source = ExploitSource('exploit-source', self.exploit_dir)

    def test_load_exploits_not_all(self):
        exploits = CurationManager.load_exploits_from_source(self.exploit_source,
                                                             self.curation_dir,
                                                             all_exploits=False)
        self.assertEqual(len(exploits), 2)

    def test_load_exploits_all(self):
        exploits = CurationManager.load_exploits_from_source(self.exploit_source,
                                                             self.curation_dir,
                                                             all_exploits=True)
        self.assertEqual(len(exploits), 4)
